var libPath=sap.zen.createStaticSdkMimeUrl("com.convista.sidenavigation","res/js/");define(["css!../js/css/sidenavigation.css"],function(){jQuery.sap.require("sap.zen.commons.layout.AbsoluteLayout"),jQuery.sap.require("sap.tnt.SideNavigation"),sap.zen.commons.layout.AbsoluteLayout.extend("com.convista.sidenavigation.SideNavigation",{setMetadata:function(value){return this._metadata=value,this},getMetadata:function(){return this._metadata},metadata:{properties:{navigationExpanded:{type:"boolean"},jsonItems:{type:"String"},jsonFixedItems:{type:"String"},selectedItemKey:{type:"String"},selectItemTrigger:{type:"String"},selectedItemText:{type:"String"}}},initDesignStudio:function(){var that=this;that.addStyleClass("scn-pack-SideNavigation"),that.addStyleClass("scn-pack-FullSizeChildren"),this._navigationList=new sap.tnt.NavigationList({items:{path:"/items",factory:function(sId,oContext){var result=null,sub=oContext.getProperty("sub"),key=oContext.getProperty("key"),text=oContext.getProperty("text"),icon=oContext.getProperty("icon");if(sub){for(var subItems=[],i=0;i<sub.length;i++)subItems.push(new sap.tnt.NavigationListItem({key:sub[i].key,text:sub[i].text}));result=new sap.tnt.NavigationListItem({key:key,text:text,items:subItems,icon:icon,expanded:!1})}else result=new sap.tnt.NavigationListItem({key:key,text:text,icon:icon});return result}},width:"100%"}),this._navigationListItemFixed=new sap.tnt.NavigationListItem({key:"{key}",text:"{text}",icon:"{icon}"}),this._navigationListFixed=new sap.tnt.NavigationList({items:{path:"/fixedItems",template:this._navigationListItemFixed},width:"100%"}),this._sideNavigation=new sap.tnt.SideNavigation({expanded:!0,item:this._navigationList,fixedItem:this._navigationListFixed}),this._myModel=new sap.ui.model.json.JSONModel,this._sideNavigation.setModel(this._myModel),this._sideNavigation.attachItemSelect(this.onItemSelect),this.addContent(this._sideNavigation)},renderer:{},onAfterRendering:function(){},afterDesignStudioUpdate:function(){if(this._sideNavigation.setExpanded(this.getNavigationExpanded()),this.getSelectItemTrigger())this._navigationList.setSelectedItem(this.getItemByKey(this.getSelectedItemKey())),this.setSelectItemTrigger("");else{try{var objItems=JSON.parse(this.getJsonItems()),objFixedItems=JSON.parse(this.getJsonFixedItems())}catch(err){window.console&&console.log("JSON parse error for fixed item strucutre "+this.getJsonItems()+"|||"+this.getJsonFixedItems()),objItems=[],objFixedItems=[]}var isInDesignMode=void 0!=sap.zen.designmode;this._myModel.setData(isInDesignMode?{items:[{key:"first",text:"First",icon:"sap-icon://action",sub:[{key:"fifth",text:"Fifth"},{key:"sixth",text:"Sixth"}]},{key:"second",text:"Second",icon:"sap-icon://action"}],fixedItems:[{key:"third",text:"First",icon:"sap-icon://action"},{key:"fourth",text:"Second",icon:"sap-icon://action"}]}:{items:objItems,fixedItems:objFixedItems})}},onItemSelect:function(oEvent){var src=oEvent.getSource().getParent().getParent(),obj=oEvent.getParameter("item");src.setSelectedItemKey(obj.getKey()),src.setSelectedItemText(obj.getText()),src.fireDesignStudioPropertiesChanged(["selectedItemKey","selectedItemText"]),src.fireDesignStudioEvent("onItemSelected")},getItemByKey:function(oKey){for(var result="",itemList=this._navigationList.getItems(),i=0;i<itemList.length;i++){var currentItem=itemList[i];currentItem.setExpanded(!1);var subItems=currentItem.getItems();if(subItems)for(var j=0;j<subItems.length;j++){var currentSubItem=subItems[j];currentSubItem.getKey()===oKey&&(currentItem.setExpanded(!0),result=currentSubItem)}currentItem.getKey()===oKey&&(result=currentItem)}for(var fixedItemList=this._navigationListFixed.getItems(),i=0;i<fixedItemList.length;i++){var currentItem=fixedItemList[i];currentItem.setExpanded(!1);var subItems=currentItem.getItems();if(subItems)for(var j=0;j<subItems.length;j++){var currentSubItem=subItems[j];currentSubItem.getKey()===oKey&&(currentItem.setExpanded(!0),result=currentSubItem)}currentItem.getKey()===oKey&&(result=currentItem)}return result}})});