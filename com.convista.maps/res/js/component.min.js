/* @version 2.0
 * @copyright ConVista
 * @author Martin Pankraz
 *
 * @classdesc GMaps Plugin for SAP Design Studio 
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(){var scriptSrc=$("script:last")[0].src;void 0!=sap.zen.createStaticSdkMimeUrl&&(scriptSrc=sap.zen.createStaticSdkMimeUrl("com.convista.maps","res/js/")),""===scriptSrc&&(scriptSrc="/aad/zen/mimes/sdk_include/com.convista.maps/res/js/"),sap.zen.Dispatcher.instance.pauseDispatching();var sdkReqs=require.config({context:"sdk",paths:{numeral:scriptSrc.substring(0,scriptSrc.indexOf("js/"))+"js/numeral.min"},rlArgs:"v=20140515"});sdkReqs(["require","numeral"],function(require,numeral){sap.designstudio.sdk.Component.subclass("com.convista.maps.DataMap",function(){function initMap(callback){if(window.initializeGmaps=function(){var label_script_found=$("#convista-label"),clusterer_script_found=$("#convista-clusterer");BASE_URL&&(0===label_script_found.length&&$("head").append('<script id="convista-label" type="text/javascript" src="'+BASE_URL+MARKERLABEL_INCLUDE+'"></script>'),0===clusterer_script_found.length&&$("head").append('<script id="convista-clusterer" type="text/javascript" src="'+BASE_URL+MARKERCLUSTER_INCLUDE+'"></script>')),that.geocoder=new google.maps.Geocoder;var mapTypeId=google.maps.MapTypeId.ROADMAP;"HYBRID"===saveMapType?mapTypeId=google.maps.MapTypeId.HYBRID:"ROADMAP"===saveMapType?mapTypeId=google.maps.MapTypeId.ROADMAP:"SATELLITE"===saveMapType?mapTypeId=google.maps.MapTypeId.SATELLITE:"TERRAIN"===saveMapType&&(mapTypeId=google.maps.MapTypeId.TERRAIN);var mapOptions={center:new google.maps.LatLng(saveCenterLat,saveCenterLon),zoom:saveZoom,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_TOP},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},panControl:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER},scaleControl:!0,overviewMapControl:!0,mapTypeId:mapTypeId};that.map=new google.maps.Map(that.$()[0],mapOptions);var mapsLayerControllDiv=document.createElement("div");if(that.mapsLayerControl=new MapsLayerControl(mapsLayerControllDiv,that.map),""!==saveKeyFigureName2){var mapsKeyfigureControllDiv=document.createElement("div");that.mapsKeyfigureDisplayControl=new MapsKeyfigureDisplayControl(mapsKeyfigureControllDiv,that.map),mapsKeyfigureControllDiv.index=1,that.map.controls[google.maps.ControlPosition.RIGHT_TOP].push(mapsKeyfigureControllDiv)}var mapsMarkerDisplayControlDiv=document.createElement("div");if(that.mapsMarkerDisplayControl=new MapsMarkerDisplayControl(mapsMarkerDisplayControlDiv,that.map),mapsLayerControllDiv.index=1,that.map.controls[google.maps.ControlPosition.LEFT_CENTER].push(mapsLayerControllDiv),mapsMarkerDisplayControlDiv.index=1,that.map.controls[google.maps.ControlPosition.TOP_CENTER].push(mapsMarkerDisplayControlDiv),saveUseClustering){var mcOptions={gridSize:saveGridSize,maxZoom:saveMaxZoom,ignoreHidden:!0,imagePath:IMAGE_URL};that.markerClusterer=new MarkerClusterer(that.map,[],mcOptions),that.markerClusterer.setZoomOnClick(!1),that.markerClusterer.setCalculator(myCalculator),google.maps.event.addListener(that.markerClusterer,"click",function(cluster){myClusterClick(cluster)})}that.trafficLayer=new google.maps.TrafficLayer,that.weatherLayer=new google.maps.weather.WeatherLayer({temperatureUnits:google.maps.weather.TemperatureUnit.CELSIUS}),that.cloudLayer=new google.maps.weather.CloudLayer,google.maps.event.addListenerOnce(that.map,"idle",function(){var c=that.map.getCenter(),z=that.map.getZoom();google.maps.event.trigger(that.map,"resize"),that.map.setCenter(c),that.map.setZoom(z)}),callback()},saveApiLoad===!0)$(document).ready(function(){var google_maps_api_found=$("#convista-maps");BASE_URL?0===google_maps_api_found.length&&$("head").append('<script id="convista-maps" type="text/javascript" src="http://maps.googleapis.com/maps/api/js?v=3.26&key='+saveAPIKey+'&libraries=weather,drawing&callback=initializeGmaps"></script>'):window.console&&console.log("App Base URL not set correctly! Please contact App designer!")}),that.apiload(!1),that.firePropertiesChanged(["apiload"]),that.apiLoadTriggered=!0;else{var gmapsApiLoaded=$("#convista-maps");gmapsApiLoaded.length>0&&that.apiLoadTriggered===!1&&void 0===that.map&&initializeGmaps()}}function initData(){if(runtime_data){var dim=null,id=null;that.id_array=[];var address=null,lat=null,lon=null,marker_text=null,additional_text=null;Array.isArray(savePopupDimension)&&(additional_text=new Array(savePopupDimension.length));for(var date=null,keyfigure2_array=[],keyfigure2=0,keyfigure1_array=[],keyfigure1=0,keyfigure2_array_diff=[],keyfigure2_diff=0,keyfigure1_array_diff=[],keyfigure1_diff=0,attribute1=null,iter_step=0,notif_position_in_dimensions_array=0,l=0;l<runtime_data.dimensions.length;l++)if(dim=runtime_data.dimensions[l],dim.containsMeasures===!0){iter_step=dim.members.length;for(var i=0;i<dim.members.length;i++)if(dim.members[i].text===saveKeyFigureName1){var format=parseNumberFormatString(dim.members[i].formatString);keyfigureFormatStrings.figure1=""===format?"0":format}else if(dim.members[i].text===saveKeyFigureName2){var format=parseNumberFormatString(dim.members[i].formatString);keyfigureFormatStrings.figure2=""===format?"0":format}else if(dim.members[i].text===saveLatDimension){var format=parseNumberFormatString(dim.members[i].formatString);keyfigureFormatStrings.lat=""===format?"0":format}else if(dim.members[i].text===saveLonDimension){var format=parseNumberFormatString(dim.members[i].formatString);keyfigureFormatStrings.lon=""===format?"0":format}}else dim.key===saveTextDimension&&(notif_position_in_dimensions_array=l);for(var tuples_grouped_by_rowKey=[],i=0,current_row_key_index=runtime_data.tuples[0][notif_position_in_dimensions_array],current_tuples_to_group=new Array;i<runtime_data.tuples.length;){var tuple=runtime_data.tuples[i];if(tuple[notif_position_in_dimensions_array]===current_row_key_index){var row=runtime_data.dimensions[1].members[tuple[1]].type;"RESULT"!==row&&current_tuples_to_group.push(tuple)}else tuples_grouped_by_rowKey.push(current_tuples_to_group),current_tuples_to_group=new Array,current_tuples_to_group.push(tuple),current_row_key_index=tuple[notif_position_in_dimensions_array];i===runtime_data.tuples.length-1&&tuples_grouped_by_rowKey.push(current_tuples_to_group),i++}for(var data_pointer=-iter_step,l=0;l<tuples_grouped_by_rowKey.length;l++){for(var i=0;i<tuples_grouped_by_rowKey[l].length;i+=iter_step){var tuple=tuples_grouped_by_rowKey[l][i];data_pointer+=iter_step;for(var j=0;j<tuple.length;j++){if(dim=runtime_data.dimensions[j],dim.key===saveAddressDimension)address=dim.members[tuple[j]].text;else if(dim.key===saveLatDimension)lat=dim.members[tuple[j]].text;else if(dim.key===saveLonDimension)lon=dim.members[tuple[j]].text;else if(dim.key===saveTextDimension)id=dim.members[tuple[j]].key,marker_text=dim.members[tuple[j]].text;else if(dim.key===saveDateDimension)date=dim.members[tuple[j]].text;else if(dim.key===saveAttribute1)attribute1=dim.members[tuple[j]].text;else if(dim.containsMeasures===!0)for(var k=0;k<dim.members.length;k++){var index=data_pointer+k,data="";dim.members[k].text===saveKeyFigureName1?null===runtime_data.data[index]||""===runtime_data.data[index]?(data=isFloat(keyfigureFormatStrings.figure1)?parseFloat("0.00").toFixed(4):"0",keyfigure1_array.push(data)):keyfigure1_array.push(runtime_data.data[index]):dim.members[k].text===saveKeyFigureName2?null===runtime_data.data[index]||""===runtime_data.data[index]?(data=isFloat(keyfigureFormatStrings.figure2)?parseFloat("0.00").toFixed(4):"0",keyfigure2_array.push(data)):keyfigure2_array.push(runtime_data.data[index]):dim.members[k].text===saveKeyFigureName1Diff?null===runtime_data.data[index]||""===runtime_data.data[index]?(data=isFloat(keyfigureFormatStrings.figure1)?parseFloat("0.00").toFixed(4):"0",keyfigure1_array_diff.push(data)):keyfigure1_array_diff.push(runtime_data.data[index]):dim.members[k].text===saveKeyFigureName2Diff?null===runtime_data.data[index]||""===runtime_data.data[index]?(data=isFloat(keyfigureFormatStrings.figure2)?parseFloat("0.00").toFixed(4):"0",keyfigure2_array_diff.push(data)):keyfigure2_array_diff.push(runtime_data.data[index]):dim.members[k].text===saveLatDimension?null===runtime_data.data[index]||""===runtime_data.data[index]?(data=isFloat(keyfigureFormatStrings.lat)?parseFloat("0.00").toFixed(4):"0",lat=data):lat=runtime_data.data[index]:dim.members[k].text===saveLonDimension&&(null===runtime_data.data[index]||""===runtime_data.data[index]?(data=isFloat(keyfigureFormatStrings.lon)?parseFloat("0.00").toFixed(4):"0",lon=data):lon=runtime_data.data[index])}if(""!==savePopupDimension&&Array.isArray(savePopupDimension)&&-1!==$.inArray(dim.key,savePopupDimension)){var idx=$.inArray(dim.key,savePopupDimension);if(-1!==idx){var obj={};obj.key=dim.text,obj.text=dim.members[tuple[j]].text,additional_text[idx]=obj}}}}for(var m=0;m<keyfigure1_array.length;m++)isInt(keyfigureFormatStrings.figure1)?(keyfigure1+=parseInt(keyfigure1_array[m],10),keyfigure1_diff+=parseInt(keyfigure1_array_diff[m],10)):(keyfigure1+=parseFloat(keyfigure1_array[m]),keyfigure1_diff+=parseFloat(keyfigure1_array_diff[m])),isInt(keyfigureFormatStrings.figure2)?(keyfigure2+=parseInt(keyfigure2_array[m],10),keyfigure2_diff+=parseInt(keyfigure2_array_diff[m],10)):(keyfigure2+=parseFloat(keyfigure2_array[m]),keyfigure2_diff+=parseFloat(keyfigure2_array_diff[m]));if(!(address&&id&&marker_text||lat&&lon||""!==saveGeojson))return void alert("There is a dimension data read error. Probably you didn't specify all necessary dimensions or you lat-long values are 0? Please review settings in Design Studio and your data source.");if(that.id_array.push(id),""!==saveGeojson)createFeature(address,[keyfigure1,keyfigure2,keyfigure1_diff,keyfigure2_diff],marker_text,"",date,id,attribute1,additional_text);else if(""!==saveLatDimension&&""!==saveLonDimension){var loc=new google.maps.LatLng(lat,lon);createMarker(address,[keyfigure1,keyfigure2,keyfigure1_diff,keyfigure2_diff],marker_text,loc,date,id,attribute1,additional_text)}else{var doc=findInAddressDatabase(address);if(null!==doc&&void 0!==doc){var loc=new google.maps.LatLng(doc.geometry.coordinates[0],doc.geometry.coordinates[1]);createMarker(address,[keyfigure1,keyfigure2,keyfigure1_diff,keyfigure2_diff],marker_text,loc,date,id,attribute1,additional_text)}else geocodeMarker(address,[keyfigure1,keyfigure2,keyfigure1_diff,keyfigure2_diff],marker_text,date,id,attribute1,additional_text)}keyfigure1_array=[],keyfigure1_array_diff=[],keyfigure2_array=[],keyfigure2_array_diff=[],keyfigure1=0,keyfigure1_diff=0,keyfigure2=0,keyfigure2_diff=0}""!==saveAttribute1&&null!==saveAttribute1&&""===saveGeojson&&(that.mapsMarkerLegendControllDiv=document.createElement("div"),that.mapsMarkerLegendControl=new MapsMarkerLegendDisplayControl(that.mapsMarkerLegendControllDiv,that.map)),that.geojsonLoaded||""===saveGeojson||(that.propertyColorsCounter=0,that.featureLength=0,that.globalGeoJsonColorCollection={},that.geoJsonLayer=new google.maps.Data,that.geoJsonLayer.addListener("addfeature",function(event){var f=event.feature,color=geojson_colors[that.propertyColorsCounter];that.globalGeoJsonColorCollection[f.getId()]=color,that.propertyColorsCounter++,that.propertyColorsCounter===that.featureLength-1&&(that.propertyColorsCounter=0),that.geoJsonLayer.overrideStyle(f,{fillColor:color,strokeColor:color,strokeWeight:1,zIndex:1})}),that.geoJsonLayer.loadGeoJson(saveGeojson,null,function(data_feature_array){that.featureLength=data_feature_array.length;for(var i=0;i<data_feature_array.length;i++){var f=data_feature_array[i],f_id=f.getId();-1!==$.inArray(f_id,that.id_array)?that.geoJsonLayer.overrideStyle(f,{visible:!0}):that.geoJsonLayer.overrideStyle(f,{visible:!1}),that.geoJsonLayer.addListener("mouseover",function(event){var f=event.feature;that.geoJsonLayer.overrideStyle(f,{fillColor:"#005696",strokeColor:"#005696",strokeWeight:2})}),that.geoJsonLayer.addListener("mouseout",function(event){var f=event.feature,color=that.globalGeoJsonColorCollection[f.getId()];that.geoJsonLayer.overrideStyle(f,{fillColor:color,strokeColor:color,strokeWeight:1})})}}),that.geoJsonLayer.addListener("click",function(event){var id=event.feature.getId(),myFeature=features[id];that.infowindow?(that.infowindow.close(),that.infowindow=new google.maps.InfoWindow):that.infowindow=new google.maps.InfoWindow;event.feature.getGeometry();if(saveMarkerHoverPopup){var additonaltext=myFeature.additonaltext,content='<div class="map-info-window"><h2>Info</h2><p>'+myFeature.text+"</p>";if(additonaltext){content+='<hr style="border-color:grey;background-color:grey">',content+="<p><i>Details</i></p>",content+="<table>";for(var i=0;i<additonaltext.length;i++)if(additonaltext[i]){content+="<tr>";var key=additonaltext[i].key,text=additonaltext[i].text;content+="<td><b>"+key+"</b></td>",content+=isUrl(text)?'<td><a href="'+text+'">'+text+"</a></td>":"<td>"+text+"</td>",content+="</tr>"}content+="</table>"}content+="</div>",that.infowindow.setContent(content),that.infowindow.setPosition(event.latLng),that.infowindow.setOptions({pixelOffset:new google.maps.Size(0,-30)}),that.infowindow.open(that.map)}var address_json='"'+saveAddressDimension+'": '+JSON.stringify(myFeature.address),date_json='"'+saveDateDimension+'":'+JSON.stringify(myFeature.date),id_json='"'+saveTextDimension+'":'+JSON.stringify(myFeature.id),transport="{";myFeature.id&&(transport+=id_json),transport+=myFeature.id&&myFeature.address?","+address_json:address_json,transport+=myFeature.date&&(myFeature.address||myFeature.id)?","+date_json:date_json,transport+="}",that.clusterselection(transport),that.addressselection(address_json),that.dateselection(date_json),that.idselection(id_json),that.address(myFeature.address),that.firePropertiesChanged(["clusterselection","addressselection","dateselection","idselection","address"]),that.fireEvent("onMarkerClicked")}),that.geoJsonLayer.setMap(that.map),that.geojsonLoaded=!0),""!==saveGeojsonDisplayOnly&&(that.dispOnlyLayer=new google.maps.Data,that.dispOnlyLayer.loadGeoJson(saveGeojsonDisplayOnly),that.dispOnlyLayer.addListener("addfeature",function(event){var f=event.feature,color=saveGeojsonDisplayOnlyColor,opacity=saveGeojsonDisplayOnlyOpacity;that.dispOnlyLayer.overrideStyle(f,{fillColor:color,strokeColor:color,strokeWeight:1,fillOpacity:opacity,zIndex:0})}),that.dispOnlyLayer.setMap(that.map))}}function hideMarkers(){if(saveUseClustering)for(var i=0;i<that.markerClusterer.markers_.length;i++)that.markerClusterer.markers_[i].setVisible(!1);else for(var i=0;i<markers.length;i++)markers[i].setVisible(!1),markers[i].setMap(null)}function showAllMarkers(){if(saveUseClustering)for(var i=0;i<that.markerClusterer.markers_.length;i++)that.markerClusterer.markers_[i].setVisible(!0);else for(var i=0;i<markers.length;i++){{markers[i].getVisible()}markers[i].getVisible()&&markers[i].setMap(that.map)}}function markClusterToShowById(id,keyfigureUpdated,position){var result=!1,myMarkers=null;if(""!==saveGeojson){var myFeature=features[id];isFloat(keyfigureUpdated[0])&&(keyfigureUpdated[0]=parseFloat(keyfigureUpdated[0]).toFixed(2)),isFloat(keyfigureUpdated[1])&&(keyfigureUpdated[1]=parseFloat(keyfigureUpdated[1]).toFixed(2)),myFeature.keyfigure1=keyfigureUpdated[0],myFeature.keyfigure2=keyfigureUpdated[1],myFeature.diff1=keyfigureUpdated[2],myFeature.diff2=keyfigureUpdated[3],myFeature.setVisible(!0),result=!0}else{myMarkers=saveUseClustering?that.markerClusterer.markers_:markers;for(var i=0;i<myMarkers.length;i++){var marker=myMarkers[i];if(marker.id==id){var color="";if(""!==saveAttribute1&&null!==saveAttribute1){for(var i=0;i<colors_for_legend.length;i++){var color_used=colors_for_legend[i].key;color_used===marker.attr&&(color=colors_for_legend[i].color)}if(""===color){var idx=colors_for_legend.length;colors_for_legend.push({key:marker.attr,color:marker_colors[idx]}),color=marker_colors[idx]}}else color="red";marker.setIcon(pinSymbol(color)),isFloat(keyfigureUpdated[0])&&(keyfigureUpdated[0]=parseFloat(keyfigureUpdated[0]).toFixed(2)),isFloat(keyfigureUpdated[1])&&(keyfigureUpdated[1]=parseFloat(keyfigureUpdated[1]).toFixed(2)),marker.keyfigure1=keyfigureUpdated[0],marker.keyfigure2=keyfigureUpdated[1],marker.diff1=keyfigureUpdated[2],marker.diff2=keyfigureUpdated[3],marker.setVisible(!0),result=!0;var currentPosition_lat=marker.getPosition().lat(),currentPosition_long=marker.getPosition().lng(),new_lat=position.lat(),new_long=position.lng();currentPosition_lat!==new_lat&&currentPosition_long!==new_long&&marker.setPosition(position);break}}}return result}function findInAddressDatabase(address){var result=null;if(address=address.toUpperCase(),ALL_ADDRESSES)for(var i=0;i<ALL_ADDRESSES.length;i++)if(ALL_ADDRESSES[i].properties.name.toUpperCase()===address){result=ALL_ADDRESSES[i];break}return result}function updateAddressDatabase(addressObject,location){var data={type:"Feature",geometry:{type:"Point",coordinates:[location.lat(),location.lng()]},properties:{name:addressObject}};if(null!==DB_URL&&void 0!==DB_URL&&""!==DB_URL)$.ajax({type:"POST",url:DB_URL,data:JSON.stringify(data),contentType:"application/json",error:function(e){window.console&&console.log(e.message)}});else{var addressObjectStore=DB.transaction(STORE_NAME,"readwrite").objectStore(STORE_NAME),request=addressObjectStore.add(data);request.onerror=function(){window.console&&console.log("Wasn't able to complete adding address to db")}}}function geocodeMarker(addressObject,key_figure,text,date,id,attribute,additional_text){setTimeout(function(){that.geocoder.geocode({address:addressObject},function(results,status){status==google.maps.GeocoderStatus.OK?(key_figure&&createMarker(addressObject,key_figure,text,results[0].geometry.location,date,id,attribute,additional_text),updateAddressDatabase(addressObject,results[0].geometry.location)):window.console&&console.log("Geocode failed for the following reason: "+status+"\n"+addressObject)})},2e3*Math.random()*2e3)}function createFeature(address,key_figure_array,text,position,date,id,attribute1,additonaltext){var feature={};feature.id=id,feature.address=address,feature.key_figure_array=key_figure_array,feature.text=text,feature.position=position,feature.date=date,feature.attribute1=attribute1,feature.additonaltext=additonaltext,features[id]=feature}function createMarker(address,key_figure_array,text,position,date,id,attribute1,additonaltext){var figure=0;figure=that.keyfiguretodisplay()===saveKeyFigureName1?0:that.keyfiguretodisplay()===saveKeyFigureName2?1:0;var color="";if(""!==saveAttribute1&&null!==saveAttribute1){for(var i=0;i<colors_for_legend.length;i++){var color_used=colors_for_legend[i].key;color_used===attribute1&&(color=colors_for_legend[i].color)}if(""===color){var idx=colors_for_legend.length;colors_for_legend.push({key:attribute1,color:marker_colors[idx]}),color=marker_colors[idx]}}else color="red";(""===saveKeyFigureName1||null===saveKeyFigureName1)&&(key_figure_array[0]=1);var marker=null,mapLabel=null;if(saveShowMarkerLabel){var labelContent="",labelClass="";saveShowTitle?(labelContent=text,labelClass="labels-text"):(labelContent=key_figure_array[0].toString(),labelClass="labels-keyfigure");var labelOptions={text:labelContent,position:position,map:that.map,fontSize:saveFontSize,fontFamily:saveFontFamily,fontColor:saveFontColor,strokeWeight:saveStrokeWeight,strokeColor:saveStrokeColor,align:"center"};-1!==saveLabelMinZoom&&(labelOptions.minZoom=saveLabelMinZoom),-1!==saveLabelMaxZoom&&(labelOptions.maxZoom=saveLabelMaxZoom),mapLabel=new MapLabel(labelOptions),mapLabel.set("position",position),marker=new google.maps.Marker({id:id,address:address,date:date,position:position,keyfigure1:key_figure_array[0],diff1:key_figure_array[2],keyfigure2:key_figure_array[1],diff2:key_figure_array[3],attr:attribute1,icon:pinSymbol(color),activeKeyfigure:figure}),marker.bindTo("map",mapLabel),marker.bindTo("position",mapLabel)}else marker=new google.maps.Marker({id:id,address:address,date:date,position:position,keyfigure1:key_figure_array[0],diff1:key_figure_array[2],keyfigure2:key_figure_array[1],diff2:key_figure_array[3],attr:attribute1,icon:pinSymbol(color),activeKeyfigure:figure});return attachPopupDetailsToMarker(marker,text,additonaltext),saveUseClustering?that.markerClusterer.addMarker(marker,!1):saveUseClustering||saveShowMarkerLabel?markers.push(marker):(marker.setMap(that.map),markers.push(marker)),marker.setVisible(!0),marker}function pinSymbol(color){var result=null;if(saveIconUrl){var anchorX=saveCustomIconAnchor.x,anchorY=saveCustomIconAnchor.y,scaleX=saveCustomIconScale.x,scaleY=saveCustomIconScale.y;result={url:saveIconUrl,anchor:new google.maps.Point(anchorX,anchorY),scaledSize:new google.maps.Size(scaleX,scaleY)}}else result="Car"===saveIcon?{path:"M128.599,64.48c0,4.771-3.84,8.645-8.575,8.645c-4.736,0-8.576-3.871-8.576-8.645c0-4.777,3.84-8.648,8.576-8.648   S128.599,59.703,128.599,64.48 M121.861,43.27H17.763L34.812,6.707h0.09c0.756-1.891,2.656-3.232,4.887-3.232   c0.042,0,0.084,0.008,0.126,0.008V3.473h59.798V3.48c0.042,0,0.083-0.008,0.126-0.008c2.231,0,4.134,1.344,4.89,3.232h0.087   L121.861,43.27z M20.412,55.832c4.736,0,8.575,3.871,8.575,8.648c0,4.771-3.839,8.645-8.575,8.645   c-4.733,0-8.575-3.871-8.575-8.645C11.837,59.703,15.677,55.832,20.412,55.832 M140.308,75.984h0.007V52.977h-0.007   c0.001-0.047,0.007-0.094,0.007-0.143c0-4.809-3.859-8.707-8.646-8.779v-0.01h-3.525l-18.854-40.43h-0.096   c-0.834-2.086-2.914-3.574-5.365-3.613V0h-67.34v0.004c-2.448,0.042-4.526,1.527-5.359,3.613h-0.101l-18.854,40.43H8.788   C3.934,44.047,0,47.98,0,52.836c0,0.049,0.007,0.096,0.007,0.143H0v23.007h0.007c0,0.046-0.007,0.093-0.007,0.14   c0,4.855,3.937,8.789,8.788,8.789c0.521,0,1.03-0.055,1.527-0.145h1.188v13.75c-0.043,0.344-0.068,0.688-0.068,1.039   c0,4.771,4.019,8.645,8.978,8.645c4.958,0,8.979-3.871,8.979-8.645c0-0.354-0.028-0.695-0.071-1.039V84.77h81.634v13.75   c-0.043,0.344-0.068,0.688-0.068,1.039c0,4.771,4.021,8.646,8.979,8.646c4.957,0,8.978-3.871,8.978-8.646   c0-0.354-0.026-0.695-0.068-1.039V84.77H130c0.496,0.09,1.006,0.146,1.527,0.146c4.854,0,8.787-3.935,8.787-8.789   C140.314,76.078,140.309,76.031,140.308,75.984",fillColor:color,fillOpacity:1,strokeColor:"#000",strokeWeight:2,scale:.3,anchor:new google.maps.Point(70,110)}:{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:color,fillOpacity:1,strokeColor:"#000",strokeWeight:2,scale:1};return result}function attachPopupDetailsToMarker(marker,detailsText,additonaltext){var content='<div class="map-info-window"><h2>Info</h2><p>'+detailsText+"</p>";if(additonaltext){content+='<hr style="border-color:grey;background-color:grey">',content+="<p><i>Details</i></p>",content+="<table>";for(var i=0;i<additonaltext.length;i++)if(additonaltext[i]){content+="<tr>";var key=additonaltext[i].key,text=additonaltext[i].text;content+="<td><b>"+key+"</b></td>",content+=isUrl(text)?'<td><a href="'+text+'">'+text+"</a></td>":"<td>"+text+"</td>",content+="</tr>"}content+="</table>"}content+="</div>",marker.desc=content;var infowindow=new google.maps.InfoWindow;infowindow.keepOpen=!1;var maps_click_event="click";saveMarkerHoverPopup||(maps_click_event="dblclick",marker.setTitle("Single click to keep window. Double click for data retrieval.")),google.maps.event.addListener(marker,maps_click_event,function(){saveMarkerHoverPopup&&(infowindow.setContent(marker.desc),infowindow.open(that.map,marker));var address_json='"'+saveAddressDimension+'": '+JSON.stringify(marker.address),date_json='"'+saveDateDimension+'":'+JSON.stringify(marker.date),id_json='"'+saveTextDimension+'":'+JSON.stringify(marker.id),transport="{";marker.id&&(transport+=id_json),transport+=marker.id&&marker.address?","+address_json:address_json,transport+=marker.date&&(marker.address||marker.id)?","+date_json:date_json,transport+="}",that.clusterselection(transport),that.addressselection(address_json),that.dateselection(date_json),that.idselection(id_json),that.address(marker.address),that.firePropertiesChanged(["clusterselection","addressselection","dateselection","idselection","address"]),that.fireEvent("onMarkerClicked")}),saveMarkerHoverPopup||(google.maps.event.addListener(marker,"mouseover",function(){infowindow.setContent(marker.desc),infowindow.open(that.map,marker)}),google.maps.event.addListener(marker,"click",function(){infowindow.keepOpen=!0}),google.maps.event.addListener(marker,"mouseout",function(){infowindow.keepOpen||infowindow.close()}),google.maps.event.addListener(infowindow,"closeclick",function(){infowindow.keepOpen=!1}))}function convertDateToInternalSAP(date_string){var date=date_string.split("."),dd=date[0],mm=date[1],yyyy=date[2];return yyyy+""+mm+dd}function parseNumberFormatString(keyfigureFormatString){var part_without_minus_operator=keyfigureFormatString.split(";")[0];return part_without_minus_operator.replace(new RegExp("#","g"),"0")}function myCalculator(markers){var index=0,title="Click marker to isolate on map view. Click button on top of the map to reset again.",count=0,count_diff=0,keyfigure_diff=0,step1=0,step2=0,step3=0,step4=0,format_string="",figure_format="";if(markers.length>0){if(0===markers[0].activeKeyfigure?figure_format=keyfigureFormatStrings.figure1:1===markers[0].activeKeyfigure&&(figure_format=keyfigureFormatStrings.figure2),void 0!==keyfigureFormatStrings.lat&&null!==keyfigureFormatStrings.lat&&""!==keyfigureFormatStrings.lat&&(figure_format="0"),isInt(figure_format))for(var i=0;i<markers.length;i++)0===markers[0].activeKeyfigure?(count+=parseInt(markers[i].keyfigure1,10),count_diff+=parseInt(markers[i].diff1,10)):1===markers[0].activeKeyfigure?(count+=parseInt(markers[i].keyfigure2,10),count_diff+=parseInt(markers[i].diff2,10)):window.console&&console.log("Active keyfigure 0 number not supported!");else if(isFloat(figure_format))for(var i=0;i<markers.length;i++)0===markers[0].activeKeyfigure?(count+=parseFloat(markers[i].keyfigure1),count_diff+=parseFloat(markers[i].diff1)):1===markers[0].activeKeyfigure?(count+=parseFloat(markers[i].keyfigure2),count_diff+=parseFloat(markers[i].diff2)):window.console&&console.log("Active keyfigure 1 number not supported!");else window.console&&console.log("Marker content to display not supported. Only use int or float!");0===markers[0].activeKeyfigure&&""!==saveKeyFigureName1ClusterSteps&&null!==saveKeyFigureName1ClusterSteps?(step1=saveKeyFigureName1ClusterSteps[0],step2=saveKeyFigureName1ClusterSteps[1],step3=saveKeyFigureName1ClusterSteps[2],step4=saveKeyFigureName1ClusterSteps[3]):1===markers[0].activeKeyfigure&&""!==saveKeyFigureName2ClusterSteps&&null!==saveKeyFigureName2ClusterSteps&&(step1=saveKeyFigureName2ClusterSteps[0],step2=saveKeyFigureName2ClusterSteps[1],step3=saveKeyFigureName2ClusterSteps[2],step4=saveKeyFigureName2ClusterSteps[3]),format_string="0 a"}return index=step1>=count?1:step2>=count?2:step3>=count?3:step4>=count?4:5,keyfigure_diff=(count-count_diff)/count,count=numeral(count).format(format_string),{text:count,index:index,title:title}}function isInt(value){var result=null,int_regex=/^-?[0-9]$/,int_regex_string=/^"-?[0-9]"$/;return result=int_regex.test(value)?!0:int_regex_string.test(value)?!0:!1}function isFloat(value){var result=null,float_regex=/^-?[0-9]+\.?[0-9]+\,?[0-9]+$/,float_regex_string=/^"-?[0-9]+\.?[0-9]+,[0-9]+"$/;return result=float_regex.test(value)?!0:float_regex_string.test(value)?!0:!1}function isUrl(value){var result=null,url_regex=/http(s)?:\/\//g;return result=url_regex.test(value)?!0:!1}function myClusterClick(cluster){var address=[],date=[],id=[];hideMarkers();for(var i=0;i<cluster.markers_.length;i++){var marker=cluster.markers_[i];address.push(marker.address),marker.date&&date.push(convertDateToInternalSAP(marker.date)),id.push(marker.id),marker.setVisible(!0)}var address_json='"'+saveAddressDimension+'": '+JSON.stringify(address),date_json='"'+saveDateDimension+'":'+JSON.stringify(date),id_json='"'+saveTextDimension+'":'+JSON.stringify(id),transport=null;transport=date?"{"+id_json+","+address_json+","+date_json+"}":"{"+id_json+","+address_json+"}",that.clusterselection(transport),that.addressselection(address_json),that.dateselection(date_json),that.idselection(id_json),that.firePropertiesChanged(["clusterselection","addressselection","dateselection","idselection"]),that.fireEvent("onClusterClick"),that.markerClusterer.repaint()}function openAddressDatabase(callback){if(window.indexedDB){var openRequest=indexedDB.open(DB_NAME,1);openRequest.onerror=function(e){window.console&&(console.log("Error opening addresses db"),console.dir(e))},openRequest.onupgradeneeded=function(e){DB=e.target.result,DB.objectStoreNames.contains(STORE_NAME)||(window.console&&console.log("create the addresses and settings objectstore"),OBJECT_STORE=DB.createObjectStore(STORE_NAME,{autoIncrement:!0}))},openRequest.onsuccess=function(e){DB=e.target.result,DB.onerror=function(event){alert("Database error: "+event.target.errorCode),window.console&&console.dir(event.target)},callback()}}else window.alert("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.")}function getAllItems(callback){var transactionType={READ_ONLY:"readonly",READ_WRITE:"readwrite"};IDBTransaction.READ_ONLY&&IDBTransaction.READ_WRITE&&(transactionType.READ_ONLY=IDBTransaction.READ_ONLY,transactionType.READ_WRITE=IDBTransaction.READ_WRITE);var trans=DB.transaction(STORE_NAME,transactionType.READ_ONLY),store=trans.objectStore(STORE_NAME),cursorRequest=store.openCursor();cursorRequest.onerror=function(error){window.console&&console.log(error)},cursorRequest.onsuccess=function(evt){var cursor=evt.target.result;cursor&&(ALL_ADDRESSES.push(cursor.value),eval("cursor.continue()"))},trans.oncomplete=function(){callback()}}function repaint(){hideMarkers(),showAllMarkers()}function MapsKeyfigureDisplayControl(controlDiv){controlDiv.style.padding="5px";var controlUIKeyfigure=document.createElement("div");controlUIKeyfigure.style.backgroundColor="white",controlUIKeyfigure.style.borderColor="grey",controlUIKeyfigure.style.borderStyle="solid",controlUIKeyfigure.style.borderWidth="1px",controlUIKeyfigure.style.cursor="pointer",controlUIKeyfigure.style.textAlign="center",controlUIKeyfigure.title="Click to switch keyfigure to show on clusters",controlUIKeyfigure.figure1=!0,controlUIKeyfigure.figure2=!1,controlDiv.appendChild(controlUIKeyfigure);var controlTextKeyfigure=document.createElement("div");controlTextKeyfigure.style.fontFamily="Arial,sans-serif",controlTextKeyfigure.style.fontSize="10px",controlTextKeyfigure.style.fontWeight="normal",controlTextKeyfigure.style.color="black",controlTextKeyfigure.style.paddingTop="2px",controlTextKeyfigure.style.paddingLeft="5px",controlTextKeyfigure.style.paddingRight="5px",controlTextKeyfigure.style.paddingBottom="2px",controlTextKeyfigure.innerHTML="<b>1</b>",that.keyfiguretodisplay()===saveKeyFigureName1?controlTextKeyfigure.innerHTML="<b>-1-</b>":that.keyfiguretodisplay()===saveKeyFigureName2&&(controlTextKeyfigure.innerHTML="<b>-2-</b>"),controlUIKeyfigure.appendChild(controlTextKeyfigure),google.maps.event.addDomListener(controlUIKeyfigure,"click",function(){if(that.runtimedata().dimensions[0].members.length>1)if(controlUIKeyfigure.figure1===!0&&""!==saveKeyFigureName2){if(controlUIKeyfigure.figure1=!1,controlUIKeyfigure.figure2=!0,controlTextKeyfigure.innerHTML="<b>-2-</b>",controlTextKeyfigure.style.color="green",saveUseClustering)for(var i=0;i<that.markerClusterer.markers_.length;i++)that.markerClusterer.markers_[i].labelContent=that.markerClusterer.markers_[i].keyfigure2.toString(),that.markerClusterer.markers_[i].activeKeyfigure=1;else for(var i=0;i<markers.length;i++)markers[i].labelContent=markers[i].keyfigure2.toString(),markers[i].activeKeyfigure=1;that.keyfiguretodisplay(saveKeyFigureName2),that.firePropertiesChanged(["keyfiguretodisplay"]),saveUseClustering?that.markerClusterer.repaint():repaint()}else if(controlUIKeyfigure.figure1===!1){if(controlUIKeyfigure.figure1=!0,controlUIKeyfigure.figure2=!1,controlTextKeyfigure.innerHTML="<b>-1-</b>",controlTextKeyfigure.style.color="black",saveUseClustering)for(var i=0;i<that.markerClusterer.markers_.length;i++)that.markerClusterer.markers_[i].labelContent=that.markerClusterer.markers_[i].keyfigure1.toString(),that.markerClusterer.markers_[i].activeKeyfigure=0;
else for(var i=0;i<markers.length;i++)markers[i].labelContent=markers[i].keyfigure1.toString(),markers[i].activeKeyfigure=0;that.keyfiguretodisplay(saveKeyFigureName1),that.firePropertiesChanged(["keyfiguretodisplay"]),saveUseClustering?that.markerClusterer.repaint():repaint()}})}function MapsMarkerDisplayControl(controlDiv){controlDiv.style.padding="5px";var controlUIMarkerDisplay=document.createElement("div");controlUIMarkerDisplay.style.backgroundColor="white",controlUIMarkerDisplay.style.borderColor="grey",controlUIMarkerDisplay.style.borderStyle="solid",controlUIMarkerDisplay.style.borderWidth="1px",controlUIMarkerDisplay.style.cursor="pointer",controlUIMarkerDisplay.style.textAlign="center",controlUIMarkerDisplay.title="Click to show all markers again",controlDiv.appendChild(controlUIMarkerDisplay);var controlTextMarkerDisplay=document.createElement("div");controlTextMarkerDisplay.style.fontFamily="Arial,sans-serif",controlTextMarkerDisplay.style.fontSize="9px",controlTextMarkerDisplay.style.fontWeight="normal",controlTextMarkerDisplay.style.color="black",controlTextMarkerDisplay.style.paddingTop="2px",controlTextMarkerDisplay.style.paddingLeft="5px",controlTextMarkerDisplay.style.paddingRight="5px",controlTextMarkerDisplay.style.paddingBottom="2px",controlTextMarkerDisplay.innerHTML="<b>Show all markers</b>",controlUIMarkerDisplay.appendChild(controlTextMarkerDisplay),google.maps.event.addDomListener(controlUIMarkerDisplay,"click",function(){showAllMarkers(),saveUseClustering?that.markerClusterer.repaint():repaint()})}function MapsMarkerLegendDisplayControl(controlDiv,map){controlDiv.style.padding="5px";var legend=document.createElement("div");legend.id="convista-legend",legend.setAttribute("class","convistaLegend");var content=[];content.push("<h3>Icon Color Legend</h3>"),content.push("<table>");for(var i=0;i<colors_for_legend.length;i++){var key=colors_for_legend[i].key,color=colors_for_legend[i].color;content.push("<tr>"),content.push('<td><div class="legend-box" style="background-color:'+color+'"></div></td>'),content.push('<td><div class="legend-text">'+key+"</div></td>"),content.push("</tr>")}content.push("</table>"),content.push('<div style="margin-left:5px; color:grey;" class="legend-text"><small>*Colors refer to Icons not Clusters</small></div>'),legend.innerHTML=content.join(""),legend.index=1,map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].length>0&&map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].clear(),map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend),controlDiv.appendChild(legend)}function updateLegendControl(){var legend=document.getElementById("convista-legend"),content=[];content.push("<h3>Icon Color Legend</h3>"),content.push("<table>");for(var i=0;i<colors_for_legend.length;i++){var key=colors_for_legend[i].key,color=colors_for_legend[i].color;content.push("<tr>"),content.push('<td><div class="legend-box" style="background-color:'+color+'"></div></td>'),content.push('<td><div class="legend-text">'+key+"</div></td>"),content.push("</tr>")}content.push("</table>"),content.push('<div style="margin-left:5px; color:grey;" class="legend-text"><small>*Colors refer to Icons not Clusters</small></div>'),legend.innerHTML=content.join("")}function MapsLayerControl(controlDiv){controlDiv.style.padding="5px";var controlUITraffic=document.createElement("div");controlUITraffic.style.backgroundColor="white",controlUITraffic.style.borderColor="grey",controlUITraffic.style.borderStyle="solid",controlUITraffic.style.borderWidth="1px",controlUITraffic.style.cursor="pointer",controlUITraffic.style.textAlign="center",controlUITraffic.title="Click to activate traffic layer",controlUITraffic.active=!1,controlDiv.appendChild(controlUITraffic);var controlTextTraffic=document.createElement("div");controlTextTraffic.style.fontFamily="Arial,sans-serif",controlTextTraffic.style.fontSize="9px",controlTextTraffic.style.fontWeight="normal",controlTextTraffic.style.color="grey",controlTextTraffic.style.paddingTop="2px",controlTextTraffic.style.paddingLeft="5px",controlTextTraffic.style.paddingRight="5px",controlTextTraffic.style.paddingBottom="2px",controlTextTraffic.innerHTML="<b>Traffic</b>",controlUITraffic.appendChild(controlTextTraffic),google.maps.event.addDomListener(controlUITraffic,"click",function(){controlUITraffic.active===!0?(controlUITraffic.active=!1,that.trafficLayer.setMap(null),controlTextTraffic.style.color="grey"):(controlUITraffic.active=!0,that.trafficLayer.setMap(that.map),controlTextTraffic.style.color="green")})}var DB_URL=null,DB_URL_EXTENSION=null,OBJECT_STORE=null,STORE_NAME="addresses",DB=null,DB_NAME="convista_maps_addresses",ALL_ADDRESSES=null,IMAGE_URL="",BASE_URL="",MARKERLABEL_INCLUDE="maplabel-compiled.js",MARKERCLUSTER_INCLUDE="markerclusterer_packed.js",OMS_INCLUDE="oms.min.js",DEFAULT_LATITUDE=50.938405,DEFAULT_LONGITUDE=6.953648,saveGeojson=null,saveGeojsonDisplayOnly=null,saveGeojsonDisplayOnlyColor=null,saveGeojsonDisplayOnlyOpacity=null,meta_data=null,runtime_data=null,saveAddressDimension=null,saveLatDimension=null,saveLonDimension=null,saveCenterLat=-1,saveCenterLon=-1,saveZoom=-1,saveMaxZoom=-1,centerLatChanged=!1,centerLngChanged=!1,mapZoomChanged=!1,clusterMaxZoomChanged=!1,saveTextDimension=null,saveMapType=null,savePopupDimension=null,saveKeyFigureName1=null,saveKeyFigureName2=null,saveKeyFigureName1ClusterSteps=null,saveKeyFigureName2ClusterSteps=null,saveDateDimension=null,saveAPIKey=null,saveApiLoad=null,saveGridSize=null,saveAttribute1=null,saveUseClustering=null,saveShowMarkerLabel=null,saveMarkerHoverPopup=null,saveShowTitle=null,saveFontSize=null,saveFontFamily=null,saveFontColor=null,saveStrokeWeight=null,saveStrokeColor=null,saveLabelMinZoom=null,saveLabelMaxZoom=null,saveIconUrl=null,saveIcon=null,saveCustomIconAnchor=null,saveCustomIconScale=null,addressData=null,clusterSelectionData=null,addressSelectionData=null,dateSelectionData=null,idSelectionData=null,keyFigureToDisplayData=null,that=this,initialize=!0,keyfigureFormatStrings=[],markers=[],features=new Object,marker_colors=["#FFFF00","#1CE6FF","#FF34FF","#FF4A46","#008941","#006FA6","#A30059","#FFDBE5","#7A4900","#0000A6","#63FFAC","#B79762","#004D43","#8FB0FF","#997D87","#5A0007","#809693","#FEFFE6","#1B4400","#4FC601","#3B5DFF"],geojson_colors=["#000000","#FFFF00","#1CE6FF","#FF34FF","#FF4A46","#008941","#006FA6","#A30059","#FFDBE5","#7A4900","#0000A6","#63FFAC","#B79762","#004D43","#8FB0FF","#997D87","#5A0007","#809693","#FEFFE6","#1B4400","#4FC601","#3B5DFF","#4A3B53","#FF2F80","#61615A","#BA0900","#6B7900","#00C2A0","#FFAA92","#FF90C9","#B903AA","#D16100","#DDEFFF","#000035","#7B4F4B","#A1C299","#300018","#0AA6D8","#013349","#00846F","#372101","#FFB500","#C2FFED","#A079BF","#CC0744","#C0B9B2","#C2FF99","#001E09","#00489C","#6F0062","#0CBD66","#EEC3FF","#456D75","#B77B68","#7A87A1","#788D66","#885578","#FAD09F","#FF8A9A","#D157A0","#BEC459","#456648","#0086ED","#886F4C","#34362D","#B4A8BD","#00A6AA","#452C2C","#636375","#A3C8C9","#FF913F","#938A81","#575329","#00FECF","#B05B6F","#8CD0FF","#3B9700","#04F757","#C8A1A1","#1E6E00","#7900D7","#A77500","#6367A9","#A05837","#6B002C","#772600","#D790FF","#9B9700","#549E79","#FFF69F","#201625","#72418F","#BC23FF","#99ADC0","#3A2465","#922329","#5B4534","#FDE8DC","#404E55","#0089A3","#CB7E98","#A4E804","#324E72","#6A3A4C","#83AB58","#001C1E","#D1F7CE","#004B28","#C8D0F6","#A3A489","#806C66","#222800","#BF5650","#E83000","#66796D","#DA007C","#FF1A59","#8ADBB4","#1E0200","#5B4E51","#C895C5","#320033","#FF6832","#66E1D3","#CFCDAC","#D0AC94","#7ED379","#012C58","#7A7BFF","#D68E01","#353339","#78AFA1","#FEB2C6","#75797C","#837393","#943A4D","#B5F4FF","#D2DCD5","#9556BD","#6A714A","#001325","#02525F","#0AA3F7","#E98176","#DBD5DD","#5EBCD1","#3D4F44","#7E6405","#02684E","#962B75","#8D8546","#9695C5","#E773CE","#D86A78","#3E89BE","#CA834E","#518A87","#5B113C","#55813B","#E704C4","#00005F","#A97399","#4B8160","#59738A","#FF5DA7","#F7C9BF","#643127","#513A01","#6B94AA","#51A058","#A45B02","#1D1702","#E20027","#E7AB63","#4C6001","#9C6966","#64547B","#97979E","#006A66","#391406","#F4D749","#0045D2","#006C31","#DDB6D0","#7C6571","#9FB2A4","#00D891","#15A08A","#BC65E9","#FFFFFE","#C6DC99","#203B3C","#671190","#6B3A64","#F5E1FF","#FFA0F2","#CCAA35","#374527","#8BB400","#797868","#C6005A","#3B000A","#C86240","#29607C","#402334","#7D5A44","#CCB87C","#B88183","#AA5199","#B5D6C3","#A38469","#9F94F0","#A74571","#B894A6","#71BB8C","#00B433","#789EC9","#6D80BA","#953F00","#5EFF03","#E4FFFC","#1BE177","#BCB1E5","#76912F","#003109","#0060CD","#D20096","#895563","#29201D","#5B3213","#A76F42","#89412E","#1A3A2A","#494B5A","#A88C85","#F4ABAA","#A3F3AB","#00C6C8","#EA8B66","#958A9F","#BDC9D2","#9FA064","#BE4700","#658188","#83A485","#453C23","#47675D","#3A3F00","#061203","#DFFB71","#868E7E","#98D058","#6C8F7D","#D7BFC2","#3C3E6E","#D83D66","#2F5D9B","#6C5E46","#D25B88","#5B656C","#00B57F","#545C46","#866097","#365D25","#252F99","#00CCFF","#674E60","#FC009C","#92896B","#1E2324","#DEC9B2","#9D4948","#85ABB4","#342142","#D09685","#A4ACAC","#00FFFF","#AE9C86","#742A33","#0E72C5","#AFD8EC","#C064B9","#91028C","#FEEDBF","#FFB789","#9CB8E4","#AFFFD1","#2A364C","#4F4A43","#647095","#34BBFF","#807781","#920003","#B3A5A7","#018615","#F1FFC8","#976F5C","#FF3BC1","#FF5F6B","#077D84","#F56D93","#5771DA","#4E1E2A","#830055","#02D346","#BE452D","#00905E","#BE0028","#6E96E3","#007699","#FEC96D","#9C6A7D","#3FA1B8","#893DE3","#79B4D6","#7FD4D9","#6751BB","#B28D2D","#E27A05","#DD9CB8","#AABC7A","#980034","#561A02","#8F7F00","#635000","#CD7DAE","#8A5E2D","#FFB3E1","#6B6466","#C6D300","#0100E2","#88EC69","#8FCCBE","#21001C","#511F4D","#E3F6E3","#FF8EB1","#6B4F29","#A37F46","#6A5950","#1F2A1A","#04784D","#101835","#E6E0D0","#FF74FE","#00A45F","#8F5DF8","#4B0059","#412F23","#D8939E","#DB9D72","#604143","#B5BACE","#989EB7","#D2C4DB","#A587AF","#77D796","#7F8C94","#FF9B03","#555196","#31DDAE","#74B671","#802647","#2A373F","#014A68","#696628","#4C7B6D","#002C27","#7A4522","#3B5859","#E5D381","#FFF3FF","#679FA0","#261300","#2C5742","#9131AF","#AF5D88","#C7706A","#61AB1F","#8CF2D4","#C5D9B8","#9FFFFB","#BF45CC","#493941","#863B60","#B90076","#003177","#C582D2","#C1B394","#602B70","#887868","#BABFB0","#030012","#D1ACFE","#7FDEFE","#4B5C71","#A3A097","#E66D53","#637B5D","#92BEA5","#00F8B3","#BEDDFF","#3DB5A7","#DD3248","#B6E4DE","#427745","#598C5A","#B94C59","#8181D5","#94888B","#FED6BD","#536D31","#6EFF92","#E4E8FF","#20E200","#FFD0F2","#4C83A1","#BD7322","#915C4E","#8C4787","#025117","#A2AA45","#2D1B21","#A9DDB0","#FF4F78","#528500","#009A2E","#17FCE4","#71555A","#525D82","#00195A","#967874","#555558","#0B212C","#1E202B","#EFBFC4","#6F9755","#6F7586","#501D1D","#372D00","#741D16","#5EB393","#B5B400","#DD4A38","#363DFF","#AD6552","#6635AF","#836BBA","#98AA7F","#464836","#322C3E","#7CB9BA","#5B6965","#707D3D","#7A001D","#6E4636","#443A38","#AE81FF","#489079","#897334","#009087","#DA713C","#361618","#FF6F01","#006679","#370E77","#4B3A83","#C9E2E6","#C44170","#FF4526","#73BE54","#C4DF72","#ADFF60","#00447D","#DCCEC9","#BD9479","#656E5B","#EC5200","#FF6EC2","#7A617E","#DDAEA2","#77837F","#A53327","#608EFF","#B599D7","#A50149","#4E0025","#C9B1A9","#03919A","#1B2A25","#E500F1","#982E0B","#B67180","#E05859","#006039","#578F9B","#305230","#CE934C","#B3C2BE","#C0BAC0","#B506D3","#170C10","#4C534F","#224451","#3E4141","#78726D","#B6602B","#200441","#DDB588","#497200","#C5AAB6","#033C61","#71B2F5","#A9E088","#4979B0","#A2C3DF","#784149","#2D2B17","#3E0E2F","#57344C","#0091BE","#E451D1","#4B4B6A","#5C011A","#7C8060","#FF9491","#4C325D","#005C8B","#E5FDA4","#68D1B6","#032641","#140023","#8683A9","#CFFF00","#A72C3E","#34475A","#B1BB9A","#B4A04F","#8D918E","#A168A6","#813D3A","#425218","#DA8386","#776133","#563930","#8498AE","#90C1D3","#B5666B","#9B585E","#856465","#AD7C90","#E2BC00","#E3AAE0","#B2C2FE","#FD0039","#009B75","#FFF46D","#E87EAC","#DFE3E6","#848590","#AA9297","#83A193","#577977","#3E7158","#C64289","#EA0072","#C4A8CB","#55C899","#E78FCF","#004547","#F6E2E3","#966716","#378FDB","#435E6A","#DA0004","#1B000F","#5B9C8F","#6E2B52","#011115","#E3E8C4","#AE3B85","#EA1CA9","#FF9E6B","#457D8B","#92678B","#00CDBB","#9CCC04","#002E38","#96C57F","#CFF6B4","#492818","#766E52","#20370E","#E3D19F","#2E3C30","#B2EACE","#F3BDA4","#A24E3D","#976FD9","#8C9FA8","#7C2B73","#4E5F37","#5D5462","#90956F","#6AA776","#DBCBF6","#DA71FF","#987C95","#52323C","#BB3C42","#584D39","#4FC15F","#A2B9C1","#79DB21","#1D5958","#BD744E","#160B00","#20221A","#6B8295","#00E0E4","#102401","#1B782A","#DAA9B5","#B0415D","#859253","#97A094","#06E3C4","#47688C","#7C6755","#075C00","#7560D5","#7D9F00","#C36D96","#4D913E","#5F4276","#FCE4C8","#303052","#4F381B","#E5A532","#706690","#AA9A92","#237363","#73013E","#FF9079","#A79A74","#029BDB","#FF0169","#C7D2E7","#CA8869","#80FFCD","#BB1F69","#90B0AB","#7D74A9","#FCC7DB","#99375B","#00AB4D","#ABAED1","#BE9D91","#E6E5A7","#332C22","#DD587B","#F5FFF7","#5D3033","#6D3800","#FF0020","#B57BB3","#D7FFE6","#C535A9","#260009","#6A8781","#A8ABB4","#D45262","#794B61","#4621B2","#8DA4DB","#C7C890","#6FE9AD","#A243A7","#B2B081","#181B00","#286154","#4CA43B","#6A9573","#A8441D","#5C727B","#738671","#D0CFCB","#897B77","#1F3F22","#4145A7","#DA9894","#A1757A","#63243C","#ADAAFF","#00CDE2","#DDBC62","#698EB1","#208462","#00B7E0","#614A44","#9BBB57","#7A5C54","#857A50","#766B7E","#014833","#FF8347","#7A8EBA","#274740","#946444","#EBD8E6","#646241","#373917","#6AD450","#81817B","#D499E3","#979440","#011A12","#526554","#B5885C","#A499A5","#03AD89","#B3008B","#E3C4B5","#96531F","#867175","#74569E","#617D9F","#E70452","#067EAF","#A697B6","#B787A8","#9CFF93","#311D19","#3A9459","#6E746E","#B0C5AE","#84EDF7","#ED3488","#754C78","#384644","#C7847B","#00B6C5","#7FA670","#C1AF9E","#2A7FFF","#72A58C","#FFC07F","#9DEBDD","#D97C8E","#7E7C93","#62E674","#B5639E","#FFA861","#C2A580","#8D9C83","#B70546","#372B2E","#0098FF","#985975","#20204C","#FF6C60","#445083","#8502AA","#72361F","#9676A3","#484449","#CED6C2","#3B164A","#CCA763","#2C7F77","#02227B","#A37E6F","#CDE6DC","#CDFFFB","#BE811A","#F77183","#EDE6E2","#CDC6B4","#FFE09E","#3A7271","#FF7B59","#4E4E01","#4AC684","#8BC891","#BC8A96","#CF6353","#DCDE5C","#5EAADD","#F6A0AD","#E269AA","#A3DAE4","#436E83","#002E17","#ECFBFF","#A1C2B6","#50003F","#71695B","#67C4BB","#536EFF","#5D5A48","#890039","#969381","#371521","#5E4665","#AA62C3","#8D6F81","#2C6135","#410601","#564620","#E69034","#6DA6BD","#E58E56","#E3A68B","#48B176","#D27D67","#B5B268","#7F8427","#FF84E6","#435740","#EAE408","#F4F5FF","#325800","#4B6BA5","#ADCEFF","#9B8ACC","#885138","#5875C1","#7E7311","#FEA5CA","#9F8B5B","#A55B54","#89006A","#AF756F","#2A2000","#7499A1","#FFB550","#00011E","#D1511C","#688151","#BC908A","#78C8EB","#8502FF","#483D30","#C42221","#5EA7FF","#785715","#0CEA91","#FFFAED","#B3AF9D","#3E3D52","#5A9BC2","#9C2F90","#8D5700","#ADD79C","#00768B","#337D00","#C59700","#3156DC","#944575","#ECFFDC","#D24CB2","#97703C","#4C257F","#9E0366","#88FFEC","#B56481","#396D2B","#56735F","#988376","#9BB195","#A9795C","#E4C5D3","#9F4F67","#1E2B39","#664327","#AFCE78","#322EDF","#86B487","#C23000","#ABE86B","#96656D","#250E35","#A60019","#0080CF","#CAEFFF","#323F61","#A449DC","#6A9D3B","#FF5AE4","#636A01","#D16CDA","#736060","#FFBAAD","#D369B4","#FFDED6","#6C6D74","#927D5E","#845D70","#5B62C1","#2F4A36","#E45F35","#FF3B53","#AC84DD","#762988","#70EC98","#408543","#2C3533","#2E182D","#323925","#19181B","#2F2E2C","#023C32","#9B9EE2","#58AFAD","#5C424D","#7AC5A6","#685D75","#B9BCBD","#834357","#1A7B42","#2E57AA","#E55199","#316E47","#CD00C5","#6A004D","#7FBBEC","#F35691","#D7C54A","#62ACB7","#CBA1BC","#A28A9A","#6C3F3B","#FFE47D","#DCBAE3","#5F816D","#3A404A","#7DBF32","#E6ECDC","#852C19","#285366","#B8CB9C","#0E0D00","#4B5D56","#6B543F","#E27172","#0568EC","#2EB500","#D21656","#EFAFFF","#682021","#2D2011","#DA4CFF","#70968E","#FF7B7D","#4A1930","#E8C282","#E7DBBC","#A68486","#1F263C","#36574E","#52CE79","#ADAAA9","#8A9F45","#6542D2","#00FB8C","#5D697B","#CCD27F","#94A5A1","#790229","#E383E6","#7EA4C1","#4E4452","#4B2C00","#620B70","#314C1E","#874AA6","#E30091","#66460A","#EB9A8B","#EAC3A3","#98EAB3","#AB9180","#B8552F","#1A2B2F","#94DDC5","#9D8C76","#9C8333","#94A9C9","#392935","#8C675E","#CCE93A","#917100","#01400B","#449896","#1CA370","#E08DA7","#8B4A4E","#667776","#4692AD","#67BDA8","#69255C","#D3BFFF","#4A5132","#7E9285","#77733C","#E7A0CC","#51A288","#2C656A","#4D5C5E","#C9403A","#DDD7F3","#005844","#B4A200","#488F69","#858182","#D4E9B9","#3D7397","#CAE8CE","#D60034","#AA6746","#9E5585","#BA6200"],colors_for_legend=[];this.init=function(){scriptSrc&&(BASE_URL=scriptSrc.substring(0,scriptSrc.indexOf("js/")),IMAGE_URL=BASE_URL+"images/m",BASE_URL+="js/"),ALL_ADDRESSES=[],this.geojsonLoaded=!1,this.apiLoadTriggered=!1},this.beforeUpdate=function(){},this.afterUpdate=function(){if(centerLatChanged===!0&&centerLngChanged===!0&&mapZoomChanged===!0&&initialize===!1&&void 0!==that.map&&(that.map.setCenter(new google.maps.LatLng(saveCenterLat,saveCenterLon)),that.map.setZoom(saveZoom),centerLatChanged=!1,centerLngChanged=!1,mapZoomChanged=!1),clusterMaxZoomChanged===!0&&initialize===!1&&void 0!==that.map&&saveUseClustering&&(that.markerClusterer.setMaxZoom(saveMaxZoom),clusterMaxZoomChanged=!1),null!==runtime_data&&runtime_data.changed===!0&&initialize===!1){runtime_data.changed=!1,colors_for_legend=[];for(var notif_position_in_dimensions_array=0,iter_step=0,l=0;l<runtime_data.dimensions.length;l++)dim=runtime_data.dimensions[l],dim.containsMeasures===!0?iter_step=dim.members.length:dim.key===saveTextDimension&&(notif_position_in_dimensions_array=l);for(var tuples_grouped_by_rowKey=[],i=0,current_row_key_index=runtime_data.tuples[0][notif_position_in_dimensions_array],current_tuples_to_group=new Array;i<runtime_data.tuples.length;){var tuple=runtime_data.tuples[i];if(tuple[notif_position_in_dimensions_array]===current_row_key_index){var row=runtime_data.dimensions[1].members[tuple[1]].type;"RESULT"!==row&&current_tuples_to_group.push(tuple)}else tuples_grouped_by_rowKey.push(current_tuples_to_group),current_tuples_to_group=new Array,current_tuples_to_group.push(tuple),current_row_key_index=tuple[notif_position_in_dimensions_array];i===runtime_data.tuples.length-1&&tuples_grouped_by_rowKey.push(current_tuples_to_group),i++}var dim=null,address=null,lat=null,lon=null,marker_text=null,additional_text=[];Array.isArray(savePopupDimension)&&(additional_text=new Array(savePopupDimension.length));var attribute=null,date=null,id_array=[],address_array=[],lat_array=[],lon_array=[],text_array=[],date_array=[],keyfigure_updated=[],additional_text_array=[],attribute_array=[],keyfigure2_array=[],keyfigure2=0,keyfigure1_array=[],keyfigure1=0,keyfigure2_array_diff=[],keyfigure2_diff=0,keyfigure1_array_diff=[],keyfigure1_diff=0,data_pointer=-iter_step;if(tuples_grouped_by_rowKey){for(var l=0;l<tuples_grouped_by_rowKey.length;l++){for(var id=0,i=0;i<tuples_grouped_by_rowKey[l].length;i+=iter_step){var tuple=tuples_grouped_by_rowKey[l][i];data_pointer+=iter_step;for(var j=0;j<tuple.length;j++){if(dim=runtime_data.dimensions[j],dim.key===saveTextDimension&&(id=dim.members[tuple[j]].key,marker_text=dim.members[tuple[j]].text),""!==savePopupDimension&&Array.isArray(savePopupDimension)){var idx=$.inArray(dim.key,savePopupDimension);if(-1!==idx){var obj={};obj.key=dim.text,obj.text=dim.members[tuple[j]].text,additional_text[idx]=obj}}if(dim.key===saveAttribute1&&(attribute=dim.members[tuple[j]].text),dim.key===saveAddressDimension&&(address=dim.members[tuple[j]].text),dim.key===saveLatDimension&&(lat=dim.members[tuple[j]].text),dim.key===saveLonDimension&&(lon=dim.members[tuple[j]].text),dim.key===saveDateDimension&&(date=dim.members[tuple[j]].text),dim.containsMeasures===!0)for(var k=0;k<dim.members.length;k++){var index=data_pointer+k,data_init="";dim.members[k].text===saveKeyFigureName1?null===runtime_data.data[index]||""===runtime_data.data[index]?(data_init=isFloat(keyfigureFormatStrings.figure1)?parseFloat("0.00").toFixed(4):"0",keyfigure1_array.push(data_init)):keyfigure1_array.push(runtime_data.data[index]):dim.members[k].text===saveKeyFigureName2?null===runtime_data.data[index]||""===runtime_data.data[index]?(data_init=isFloat(keyfigureFormatStrings.figure2)?parseFloat("0.00").toFixed(4):"0",keyfigure2_array.push(data_init)):keyfigure2_array.push(runtime_data.data[index]):dim.members[k].text===saveKeyFigureName1Diff?null===runtime_data.data[index]||""===runtime_data.data[index]?(data_init=isFloat(keyfigureFormatStrings.figure1)?parseFloat("0.00").toFixed(4):"0",keyfigure1_array_diff.push(data_init)):keyfigure1_array_diff.push(runtime_data.data[index]):dim.members[k].text===saveKeyFigureName2Diff?null===runtime_data.data[index]||""===runtime_data.data[index]?(data_init=isFloat(keyfigureFormatStrings.figure2)?parseFloat("0.00").toFixed(4):"0",keyfigure2_array_diff.push(data_init)):keyfigure2_array_diff.push(runtime_data.data[index]):dim.members[k].text===saveLatDimension?null===runtime_data.data[index]||""===runtime_data.data[index]?(data_init=isFloat(keyfigureFormatStrings.lat)?parseFloat("0.00").toFixed(4):"0",lat=data_init):lat=runtime_data.data[index]:dim.members[k].text===saveLonDimension&&(null===runtime_data.data[index]||""===runtime_data.data[index]?(data_init=isFloat(keyfigureFormatStrings.lon)?parseFloat("0.00").toFixed(4):"0",lon=data_init):lon=runtime_data.data[index])}}}id_array.push(id),address_array.push(address),text_array.push(marker_text),date_array.push(date),attribute_array.push(attribute),additional_text_array.push(additional_text),lat_array.push(lat),lon_array.push(lon);for(var m=0;m<keyfigure1_array.length;m++)isInt(keyfigureFormatStrings.figure1)?(keyfigure1+=parseInt(keyfigure1_array[m],10),keyfigure1_diff+=parseInt(keyfigure1_array_diff[m],10)):(keyfigure1+=parseFloat(keyfigure1_array[m]),keyfigure1_diff+=parseFloat(keyfigure1_array_diff[m])),isInt(keyfigureFormatStrings.figure2)?(keyfigure2+=parseInt(keyfigure2_array[m],10),keyfigure2_diff+=parseInt(keyfigure2_array_diff[m],10)):(keyfigure2+=parseFloat(keyfigure2_array[m]),keyfigure2_diff+=parseFloat(keyfigure2_array_diff[m]));(""===saveKeyFigureName1||null===saveKeyFigureName1)&&(keyfigure1=1),keyfigure_updated[l]=[keyfigure1,keyfigure2,keyfigure1_diff,keyfigure2_diff],keyfigure1_array=[],keyfigure2_array=[],keyfigure1_array_diff=[],keyfigure2_array_diff=[],keyfigure1=0,keyfigure2=0,keyfigure1_diff=0,keyfigure2_diff=0}hideMarkers();for(var i=0;i<id_array.length;i++)if(""!==saveGeojson)createFeature(address_array[i],keyfigure_updated[i],text_array[i],loc,date_array[i],id_array[i],attribute_array[i],additional_text_array[i]);else{var position=new google.maps.LatLng(lat_array[i],lon_array[i]),marker_updated=markClusterToShowById(id_array[i],keyfigure_updated[i],position);if(marker_updated===!1)if(""!==saveLatDimension&&""!==saveLonDimension)createMarker(address_array[i],keyfigure_updated[i],text_array[i],position,date_array[i],id_array[i],attribute_array[i],additional_text_array[i]);else{var doc=findInAddressDatabase(address_array[i]);if(null!==doc&&void 0!==doc){var loc=new google.maps.LatLng(doc.geometry.coordinates[0],doc.geometry.coordinates[1]);createMarker(address_array[i],keyfigure_updated[i],text_array[i],loc,date_array[i],id_array[i],attribute_array[i],additional_text_array[i])}}}""!==saveGeojson&&that.geoJsonLayer.forEach(function(feature){var f_id=feature.getId();-1!==$.inArray(f_id,id_array)?that.geoJsonLayer.overrideStyle(feature,{visible:!0}):that.geoJsonLayer.overrideStyle(feature,{visible:!1})}),""!==saveAttribute1&&null!==saveAttribute1&&""===saveGeojson&&updateLegendControl(),saveUseClustering?this.markerClusterer.repaint():showAllMarkers(),keyfigure_updated=[],id_array=[]}else alert("Chosen dataset is empty.")}initialize===!0&&(null!==DB_URL&&void 0!==DB_URL&&""!==DB_URL?($.ajax({type:"GET",url:DB_URL+DB_URL_EXTENSION,async:!1,contentType:"application/json",success:function(json){for(var rows=JSON.parse(json).rows,i=0;i<rows.length;i++)ALL_ADDRESSES.push(rows[i].doc)},error:function(e){window.console&&console.log(e.statusText)}}),initMap(function(){initData()}),initialize=!1):""!==saveLatDimension&&""!==saveLonDimension?(initMap(function(){initData()}),initialize=!1):(openAddressDatabase(function(){getAllItems(function(){initMap(function(){initData()})})}),initialize=!1))},this.componentDeleted=function(){var c=that.map.getCenter(),z=that.map.getZoom();that.centerlat(c.lat()),that.centerlon(c.lng()),that.zoom(z),that.maxzoom(that.markerClusterer.getMaxZoom()),that.firePropertiesChanged(["centerlat","centerlon","zoom","maxzoom"])},this.metadata=function(value){return void 0===value?meta_data:(meta_data=value,this)},this.runtimedata=function(value){return void 0===value?runtime_data:(null!==runtime_data&&""!==runtime_data&&void 0!==runtime_data.tuples&&void 0!==value.tuples?runtime_data.tuples.length!==value.tuples.length?(runtime_data=value,runtime_data.changed=!0):runtime_data.data.length===value.data.length&&runtime_data.data.every(function(v,idx){return v===value.data[idx]})?(runtime_data=value,runtime_data.changed=!1):(runtime_data=value,runtime_data.changed=!0):(runtime_data=value,runtime_data.changed=!1),this)},this.apikey=function(value){return void 0===value?saveAPIKey:(saveAPIKey=value,this)},this.databaseaddress=function(value){return void 0===value?DB_URL:(DB_URL=value,this)},this.databaseaddressextension=function(value){return void 0===value?DB_URL_EXTENSION:(DB_URL_EXTENSION=value,this)},this.maptype=function(value){return void 0===value?saveMapType:(saveMapType=value,this)},this.address=function(value){return void 0===value?addressData:(addressData=value,this)},this.clusterselection=function(value){return void 0===value?clusterSelectionData:(clusterSelectionData=value,this)},this.addressselection=function(value){return void 0===value?addressSelectionData:(addressSelectionData=value,this)},this.dateselection=function(value){return void 0===value?dateSelectionData:(dateSelectionData=value,this)},this.idselection=function(value){return void 0===value?idSelectionData:(idSelectionData=value,this)},this.addressdimension=function(value){return void 0===value?saveAddressDimension:(saveAddressDimension=value,this)},this.lat=function(value){return void 0===value?saveLatDimension:(saveLatDimension=value,this)},this.lon=function(value){return void 0===value?saveLonDimension:(saveLonDimension=value,this)},this.centerlat=function(value){return void 0===value?saveCenterLat:(-1!==saveCenterLat&&saveCenterLat!==value&&(centerLatChanged=!0),saveCenterLat=value,this)},this.centerlon=function(value){return void 0===value?saveCenterLon:(-1!==saveCenterLon&&saveCenterLon!==value&&(centerLngChanged=!0),saveCenterLon=value,this)},this.zoom=function(value){return void 0===value?saveZoom:(-1!==saveZoom&&saveZoom!==value&&(mapZoomChanged=!0),saveZoom=value,this)},this.maxzoom=function(value){return void 0===value?saveMaxZoom:(-1!==saveMaxZoom&&saveMaxZoom!==value&&(clusterMaxZoomChanged=!0),saveMaxZoom=value,this)},this.gridsize=function(value){return void 0===value?saveGridSize:(saveGridSize=value,this)},this.textdimension=function(value){return void 0===value?saveTextDimension:(saveTextDimension=value,this)},this.popupdimension=function(value){return void 0===value?savePopupDimension:(savePopupDimension=value,this)},this.datedimension=function(value){return void 0===value?saveDateDimension:(saveDateDimension=value,this)},this.keyfigurename1=function(value){return void 0===value?saveKeyFigureName1:(saveKeyFigureName1=value,this)},this.keyfigurename1diff=function(value){return void 0===value?saveKeyFigureName1Diff:(saveKeyFigureName1Diff=value,this)},this.keyfigurename1clustersteps=function(value){if(void 0===value)return saveKeyFigureName1ClusterSteps;try{saveKeyFigureName1ClusterSteps=""!==value?JSON.parse(value):value}catch(e){window.console&&console.log("invalid json for cluster steps for keyfigure1 :"+value)}return this},this.keyfigurename2=function(value){return void 0===value?saveKeyFigureName2:(saveKeyFigureName2=value,this)},this.keyfigurename2diff=function(value){return void 0===value?saveKeyFigureName2Diff:(saveKeyFigureName2Diff=value,this)},this.attribute1=function(value){return void 0===value?saveAttribute1:(saveAttribute1=value,this)},this.useclustering=function(value){return void 0===value?saveUseClustering:(saveUseClustering=value,this)},this.showmarkerlabel=function(value){return void 0===value?saveShowMarkerLabel:(saveShowMarkerLabel=value,this)},this.markerhoverpopup=function(value){return void 0===value?saveMarkerHoverPopup:(saveMarkerHoverPopup=value,this)},this.showtitle=function(value){return void 0===value?saveShowTitle:(saveShowTitle=value,this)},this.fontsize=function(value){return void 0===value?saveFontSize:(saveFontSize=value,this)},this.fontfamily=function(value){return void 0===value?saveFontFamily:(saveFontFamily=value,this)},this.fontcolor=function(value){return void 0===value?saveFontColor:(saveFontColor=value,this)},this.strokeweight=function(value){return void 0===value?saveStrokeWeight:(saveStrokeWeight=value,this)},this.strokecolor=function(value){return void 0===value?saveStrokeColor:(saveStrokeColor=value,this)},this.labelminzoom=function(value){return void 0===value?saveLabelMinZoom:(saveLabelMinZoom=value,this)},this.labelmaxzoom=function(value){return void 0===value?saveLabelMaxZoom:(saveLabelMaxZoom=value,this)},this.keyfigurename2clustersteps=function(value){if(void 0===value)return saveKeyFigureName2ClusterSteps;try{saveKeyFigureName2ClusterSteps=""!==value?JSON.parse(value):value}catch(e){window.console&&console.log("invalid json for cluster steps for keyfigure2 : "+value)}return this},this.keyfiguretolerance=function(value){return void 0===value?saveKeyFigureTolerance:(isFloat(value)?saveKeyFigureTolerance=value:isInt(value)?saveKeyFigureTolerance=value/100:window.console&&console.log("Wrong or missing input for keyfigure tolerance! "+value),this)},this.keyfiguretodisplay=function(value){if(void 0===value||""===value)return keyFigureToDisplayData;if(keyFigureToDisplayData!==value&&null!==keyFigureToDisplayData&&""!==keyFigureToDisplayData){if(value===that.keyfigurename1())if(saveUseClustering)for(var i=0;i<that.markerClusterer.markers_.length;i++)that.markerClusterer.markers_[i].labelContent=that.markerClusterer.markers_[i].keyfigure1.toString(),that.markerClusterer.markers_[i].activeKeyfigure=0;else for(var i=0;i<markers.length;i++)markers[i].labelContent=markers[i].keyfigure1.toString(),markers[i].activeKeyfigure=0;else if(value===that.keyfigurename2())if(saveUseClustering)for(var i=0;i<that.markerClusterer.markers_.length;i++)that.markerClusterer.markers_[i].labelContent=that.markerClusterer.markers_[i].keyfigure2.toString(),that.markerClusterer.markers_[i].activeKeyfigure=1;else for(var i=0;i<markers.length;i++)markers[i].labelContent=markers[i].keyfigure2.toString(),markers[i].activeKeyfigure=1;saveUseClustering?that.markerClusterer.repaint():repaint()}return keyFigureToDisplayData=value,this},this.apiload=function(value){return void 0===value?saveApiLoad:void(saveApiLoad=value)},this.geojson=function(value){return void 0===value?saveGeojson:void(saveGeojson=value)},this.geojsondisplayonly=function(value){return void 0===value?saveGeojsonDisplayOnly:void(saveGeojsonDisplayOnly=value)},this.geojsondisplayonlycolor=function(value){return void 0===value?saveGeojsonDisplayOnlyColor:void(saveGeojsonDisplayOnlyColor=value)},this.geojsondisplayonlyopacity=function(value){return void 0===value?saveGeojsonDisplayOnlyOpacity:void(saveGeojsonDisplayOnlyOpacity=value)},this.icon=function(value){return void 0===value?saveIcon:void(saveIcon=value)},this.iconUrl=function(value){return void 0===value?saveIconUrl:void(saveIconUrl=value)},this.customIconAnchor=function(value){return void 0===value?saveCustomIconAnchor:void(saveCustomIconAnchor=value)},this.customIconScale=function(value){return void 0===value?saveCustomIconScale:void(saveCustomIconScale=value)}}),sap.zen.Dispatcher.instance.resumeDispatching()
})}();